<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medteria 問題集テスト</title>
    
    <!-- Tailwind CSSの読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts (Inter) の読み込み -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- アイコンライブラリ (Lucide) の読み込み -->
    <script src="https://unpkg.com/lucide-react@latest/dist/lucide-react.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* カスタムスタイル */
        body {
            font-family: 'Noto Sans JP', 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent; /* スマホでのタップ時のハイライトを無効化 */
        }
        /* グラデーション背景 */
        .gradient-bg {
            background-color: #f0f9ff;
            background-image: radial-gradient(at 47% 33%, hsl(205.00, 90%, 95%) 0, transparent 59%), radial-gradient(at 82% 65%, hsl(215.00, 80%, 95%) 0, transparent 55%);
        }
        /* 選択肢のカスタムスタイル */
        .option-btn.selected {
            background-color: #3b82f6; /* 青 */
            color: white;
            border-color: #3b82f6;
        }
        .option-btn.correct {
            background-color: #22c55e; /* 緑 */
            color: white;
            border-color: #22c55e;
        }
        .option-btn.incorrect {
            background-color: #ef4444; /* 赤 */
            color: white;
            border-color: #ef4444;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen text-slate-800">

    <div id="app-container" class="pb-32">

        <!-- ヘッダー -->
        <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-20 shadow-sm">
            <div class="max-w-4xl mx-auto px-4">
                <div class="flex justify-between items-center h-16">
                    <h1 class="text-lg font-bold text-blue-600">Medteria 問題集テスト</h1>
                    <div class="flex items-center space-x-4">
                        <button class="text-slate-600 hover:text-blue-600 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                        </button>
                        <button id="settings-btn" class="text-slate-600 hover:text-blue-600 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- メインコンテンツ -->
        <main class="max-w-4xl mx-auto p-4 md:p-6">
            <div id="question-area" class="bg-white rounded-xl shadow-md p-5 md:p-8">
                <!-- 問題番号と難易度 -->
                <div id="question-header" class="flex justify-between items-center mb-4">
                    <p id="question-number" class="text-xl font-bold text-blue-600"></p>
                    <span id="question-difficulty" class="text-xs font-semibold bg-blue-100 text-blue-700 px-2 py-1 rounded-full"></span>
                </div>

                <!-- 問題文 -->
                <div id="question-text" class="text-lg leading-relaxed mb-6 whitespace-pre-wrap"></div>

                <!-- 選択肢 -->
                <div id="options-container" class="grid grid-cols-1 gap-3 mb-6">
                    <!-- JSで動的に生成 -->
                </div>

                <!-- 操作ボタン -->
                <div class="flex flex-col sm:flex-row gap-4">
                    <button id="skip-btn" class="w-full sm:w-1/2 flex-1 text-center py-3 px-4 rounded-lg font-semibold bg-slate-200 text-slate-700 hover:bg-slate-300 transition-all duration-200">
                        スキップ
                    </button>
                    <button id="show-answer-btn" class="w-full sm:w-1/2 flex-1 text-center py-3 px-4 rounded-lg font-semibold text-white bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
                        回答を表示
                    </button>
                </div>
            </div>

            <!-- 解説エリア -->
            <div id="explanation-container" class="hidden mt-6 bg-white rounded-xl shadow-md p-5 md:p-8">
                 <h2 class="text-xl font-bold mb-4 text-gray-800 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-check text-green-500 mr-2"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="m9 14 2 2 4-4"/></svg>
                    正解・解説
                </h2>
                <div id="correct-answer-text" class="mb-4 text-lg font-bold text-green-600"></div>
                <div id="explanation-text" class="text-base leading-relaxed whitespace-pre-wrap"></div>
            </div>
        </main>
    </div>

    <!-- フッターナビゲーション -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-lg border-t border-slate-200 shadow-[0_-2px_10px_rgba(0,0,0,0.05)] z-20">
        <div class="max-w-4xl mx-auto px-4 flex justify-between items-center h-20">
            <button class="flex flex-col items-center text-slate-600 hover:text-blue-600 transition-colors w-1/4">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layout-grid"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>
                <span class="text-xs mt-1">一覧</span>
            </button>
            <button id="prev-btn" class="flex flex-col items-center text-slate-600 hover:text-blue-600 transition-colors w-1/4 disabled:opacity-40 disabled:hover:text-slate-600">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left-circle"><circle cx="12" cy="12" r="10"/><path d="M16 12H8"/><path d="m12 8-4 4 4 4"/></svg>
                <span class="text-xs mt-1">前の問題</span>
            </button>
            <button class="flex flex-col items-center text-slate-600 hover:text-blue-600 transition-colors w-1/4">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bookmark"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/></svg>
                <span class="text-xs mt-1">クリップ</span>
            </button>
            <button id="next-btn" class="flex flex-col items-center text-slate-600 hover:text-blue-600 transition-colors w-1/4 disabled:opacity-40 disabled:hover:text-slate-600">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right-circle"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="m12 16 4-4-4-4"/></svg>
                <span class="text-xs mt-1">次の問題</span>
            </button>
        </div>
    </nav>

    <!-- フッター -->
    <footer class="text-center text-xs text-slate-500 py-4">
        <p>&copy; 2025 copyright Medteria All rights reserved.</p>
    </footer>

    <!-- 設定モーダル -->
    <div id="settings-modal" class="hidden fixed inset-0 bg-black/60 z-30 flex items-center justify-center p-4">
        <div id="modal-content" class="bg-white rounded-xl shadow-2xl w-full max-w-sm transform transition-all opacity-0 -translate-y-10">
            <div class="p-6">
                <h3 class="text-lg font-bold mb-4">解答状況</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between"><span>現在の問題:</span> <span id="modal-current-q"></span></div>
                    <div class="flex justify-between"><span>総問題数:</span> <span id="modal-total-q"></span></div>
                    <div class="flex justify-between"><span>正解数:</span> <span>(未実装)</span></div>
                </div>
            </div>
            <div class="bg-slate-50 px-6 py-4 flex flex-col sm:flex-row-reverse gap-3 rounded-b-xl">
                <button class="w-full sm:w-auto sm:ml-2 inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700">保存して終了する</button>
                <button id="close-modal-btn" class="w-full sm:w-auto mt-2 sm:mt-0 inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50">閉じる</button>
            </div>
        </div>
    </div>


    <script>
        // --- データセット ---
        const questions = [
            {
                id: 1,
                questionText: "インスリン分泌促進系に分類されるのはどれか。",
                options: [
                    { id: "a", text: "チアゾリジン薬" },
                    { id: "b", text: "ビグアナイド薬" },
                    { id: "c", text: "α-グルコシダーゼ阻害薬" },
                    { id: "d", text: "DPP-4 (dipeptidyl peptidase-4) 阻害薬" },
                    { id: "e", text: "SGLT2 (sodium glucose cotransporter 2) 阻害薬" },
                ],
                correctAnswer: ["d"],
                explanation: "本問は血糖降下薬の作用機序による分類を問う問題です。\n• a. チアゾリジン薬： PPARγを活性化し、インスリン抵抗性を改善します。インスリン分泌は促進しません。\n• b. ビグアナイド薬： 主に肝臓での糖新生を抑制し、インスリン抵抗性を改善します。インスリン分泌は促進しません。\n• c. α-グルコシダーゼ阻害薬： 腸管での二糖類の分解を阻害し、糖の吸収を遅らせます。インスリン分泌は促進しません。\n• d. DPP-4阻害薬： インクレチン（GLP-1など）の分解を阻害することで血中濃度を高め、血糖依存的にインスリン分泌を促進し、グルカゴン分泌を抑制します。これが正解です。\n• e. SGLT2阻害薬： 腎臓の近位尿細管でのブドウ糖再吸収を抑制し、尿中への糖排泄を促進します。インスリン非依存的に血糖を低下させます。",
                difficulty: "国家試験より易しい",
                isMultiSelect: false,
            },
            {
                id: 2,
                questionText: "ツベルクリン反応に関連する免疫反応はどれか。",
                options: [
                    { id: "a", text: "I型アレルギー" },
                    { id: "b", text: "II型アレルギー" },
                    { id: "c", text: "III型アレルギー" },
                    { id: "d", text: "IV型アレルギー" },
                    { id: "e", text: "V型アレルギー" },
                ],
                correctAnswer: ["d"],
                explanation: "ツベルクリン反応は、結核菌に対する細胞性免疫の有無を調べる皮内反応であり、Gell-Coombs分類における**IV型アレルギー（遅延型アレルギー）**の代表例です。抗原提示細胞によって提示された結核菌抗原に対し、感作T細胞が反応し、サイトカインを放出してマクロファージなどを活性化させることで、48〜72時間後に発赤・硬結がピークに達します。\n• I型（即時型）： IgEが関与。花粉症、気管支喘息、アナフィラキシーなど。\n• II型（細胞障害型）： IgG, IgMが自己の細胞表面抗原に結合し、補体や食細胞を介して細胞を破壊。自己免疫性溶血性貧血、血小板減少症など。\n• III型（免疫複合体型）： 抗原と抗体（IgG, IgM）の免疫複合体が組織に沈着し、補体を活性化して炎症を引き起こす。ループス腎炎、血清病など。",
                difficulty: "国家試験より易しい",
                isMultiSelect: false,
            },
            {
                id: 3,
                questionText: "Which contributes to coordinated movement?",
                options: [
                    { id: "a", text: "Frontal lobe" },
                    { id: "b", text: "Parietal lobe" },
                    { id: "c", text: "Occipital lobe" },
                    { id: "d", text: "Temporal lobe" },
                    { id: "e", text: "Cerebellum" },
                ],
                correctAnswer: ["e"],
                explanation: "協調運動（coordinated movement）は、複数の筋肉の活動を時間的・空間的に適切に統合し、滑らかで正確な運動を実現する機能です。この中枢は**小脳（Cerebellum）**です。小脳が障害されると、運動失調（ataxia）をきたし、測定障害（dysmetria）や協調運動反復不能（adiadochokinesis）などがみられます。\n• a. 前頭葉： 思考、意思決定、運動の企画（運動野）。\n• b. 頭頂葉： 感覚情報の統合（体性感覚野）。\n• c. 後頭葉： 視覚情報の処理（視覚野）。\n• d. 側頭葉： 聴覚、記憶、言語理解（ウェルニッケ野）。",
                difficulty: "国家試験より易しい",
                isMultiSelect: false,
            },
            {
                id: 28,
                questionText: "35歳の男性。左顎下部の腫脹を主訴に来院した。数か月前より時々起こる左顎下部の腫脹に気付いていたが経過をみていた。最近食後に左顎下部腫脹が頻繁に起こり、数時間で腫脹は改善する。腫脹時は軽度の痛みを伴うため来院した。身長 174 cm、体重 70.5 kg。体温 36.4℃。左顎下腺は右よりやや大きく、全体的に硬く触知した。触診により軽度の圧痛を伴った。血液所見：赤血球 515万、Hb 15.2 g/dL、Ht 44.5%、白血球 8,600、血小板 19.8万。血液生化学所見：総蛋白 7.5 g/dL、アルブミン 4.2 g/dL、総ビリルビン 1.0 mg/dL、AST 19 U/L、ALT 24 U/L、LD 173 U/L（基準120～245）、ALP 67 U/L（基準38～113）、アミラーゼ 155 U/L（基準37～160）、CK 110 U/L（基準30～140）、尿素窒素 19 mg/dL、クレアチニン 0.69 mg/dL。CRP 1.2 mg/dL。\n\n確定診断に必要な検査はどれか。2つ選べ。",
                options: [
                    { id: "a", text: "頸部CT" },
                    { id: "b", text: "IgG4測定" },
                    { id: "c", text: "抗SS-A抗体測定" },
                    { id: "d", text: "口腔底の双手診" },
                    { id: "e", text: "穿刺吸引細胞診" },
                ],
                correctAnswer: ["a", "d"],
                explanation: "食事のたびに繰り返す顎下部の腫脹と疼痛は、唾石症による唾液のうっ滞（唾仙痛）を強く示唆します。特に顎下腺に好発します。\n• a. 頸部CT: 唾石の存在部位や大きさ、顎下腺の腫脹や炎症の程度を評価するために非常に有用です。特に石灰化の程度が低い唾石の描出に優れます。\n• d. 口腔底の双手診: 口腔内からと口腔外からの両方から触診することで、顎下腺管内の唾石を触知できることがあります。基本的な診察手技として重要です。\n• b. IgG4測定やc. 抗SS-A抗体測定は、それぞれIgG4関連疾患やシェーグレン症候群といった自己免疫性唾液腺炎を疑う場合に行いますが、本症例のように食事と関連した間欠的な症状からは、まず唾石症を考えます。\n• e. 穿刺吸引細胞診は、腫瘍性病変が疑われる場合に行いますが、第一選択の検査ではありません。",
                difficulty: "★★★☆☆ 国家試験レベル",
                isMultiSelect: true,
            }
        ];

        // --- DOM要素の取得 ---
        const questionNumberEl = document.getElementById('question-number');
        const questionDifficultyEl = document.getElementById('question-difficulty');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainerEl = document.getElementById('options-container');
        const explanationContainerEl = document.getElementById('explanation-container');
        const correctAnswerTextEl = document.getElementById('correct-answer-text');
        const explanationTextEl = document.getElementById('explanation-text');
        const showAnswerBtn = document.getElementById('show-answer-btn');
        const skipBtn = document.getElementById('skip-btn');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');
        const settingsBtn = document.getElementById('settings-btn');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const settingsModal = document.getElementById('settings-modal');
        const modalContent = document.getElementById('modal-content');
        const modalCurrentQ = document.getElementById('modal-current-q');
        const modalTotalQ = document.getElementById('modal-total-q');


        // --- 状態管理 ---
        let currentQuestionIndex = 0;
        let selectedAnswers = [];
        let isAnswered = false;

        // --- 関数定義 ---

        /** URLから問題インデックスを取得 */
        function getQuestionIndexFromURL() {
            const params = new URLSearchParams(window.location.search);
            const q = parseInt(params.get('q'), 10);
            if (!isNaN(q) && q > 0 && q <= questions.length) {
                return q - 1;
            }
            return 0;
        }
        
        /** URLを更新 */
        function updateURL(index) {
            const questionNumber = index + 1;
            const url = new URL(window.location);
            url.searchParams.set('q', questionNumber);
            // ページリフレッシュのような挙動を再現するため、pushStateでURLを更新
            window.history.pushState({path: url.href}, '', url.href);
        }

        /** 問題を描画する関数 */
        function renderQuestion(index) {
            // 状態をリセット
            isAnswered = false;
            selectedAnswers = [];

            const question = questions[index];
            
            // 画面をトップにスクロール
            window.scrollTo(0, 0);

            // 問題情報を設定
            questionNumberEl.textContent = `問題 ${question.id}`;
            questionDifficultyEl.textContent = question.difficulty;
            questionTextEl.textContent = question.questionText;

            // 選択肢をクリアして再生成
            optionsContainerEl.innerHTML = '';
            question.options.forEach(option => {
                const button = document.createElement('button');
                button.classList.add('option-btn', 'w-full', 'text-left', 'p-4', 'border-2', 'border-slate-300', 'rounded-lg', 'hover:border-blue-500', 'hover:bg-blue-50', 'transition-all', 'duration-200');
                button.dataset.optionId = option.id;
                
                const label = document.createElement('span');
                label.classList.add('mr-3', 'font-bold', 'text-blue-600');
                label.textContent = option.id.toUpperCase();

                button.appendChild(label);
                button.append(option.text);

                button.addEventListener('click', () => handleOptionClick(option.id));
                optionsContainerEl.appendChild(button);
            });
            
            // 解説エリアを非表示
            explanationContainerEl.classList.add('hidden');

            // ボタンの状態を更新
            showAnswerBtn.disabled = true;
            prevBtn.disabled = index === 0;
            nextBtn.disabled = index === questions.length - 1;
            skipBtn.disabled = index === questions.length - 1;
        }

        /** 選択肢クリック時の処理 */
        function handleOptionClick(optionId) {
            if (isAnswered) return;

            const question = questions[currentQuestionIndex];
            const button = optionsContainerEl.querySelector(`[data-option-id="${optionId}"]`);
            
            if (question.isMultiSelect) {
                // 複数選択の場合
                const index = selectedAnswers.indexOf(optionId);
                if (index > -1) {
                    selectedAnswers.splice(index, 1);
                    button.classList.remove('selected');
                } else {
                    selectedAnswers.push(optionId);
                    button.classList.add('selected');
                }
            } else {
                // 単一選択の場合
                selectedAnswers = [optionId];
                // 他の選択肢のハイライトを解除
                document.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');
            }

            showAnswerBtn.disabled = selectedAnswers.length === 0;
        }

        /** 回答を表示する処理 */
        function showAnswer() {
            if (isAnswered || selectedAnswers.length === 0) return;
            isAnswered = true;

            const question = questions[currentQuestionIndex];
            const correctAnswers = question.correctAnswer;
            
            // 正解・不正解をハイライト
            document.querySelectorAll('.option-btn').forEach(btn => {
                const optionId = btn.dataset.optionId;
                const isCorrect = correctAnswers.includes(optionId);
                const isSelected = selectedAnswers.includes(optionId);

                btn.classList.remove('selected');

                if (isCorrect) {
                    btn.classList.add('correct');
                } else if (isSelected && !isCorrect) {
                    btn.classList.add('incorrect');
                }
            });

            // 解説を表示
            correctAnswerTextEl.textContent = `正解: ${correctAnswers.join(', ').toUpperCase()}`;
            explanationTextEl.textContent = question.explanation;
            explanationContainerEl.classList.remove('hidden');
            
            // 解説が表示されたら、その位置までスクロール
            explanationContainerEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        /** 次の問題へ進む */
        function goToNext() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                updateURL(currentQuestionIndex);
                renderQuestion(currentQuestionIndex);
            }
        }

        /** 前の問題へ戻る */
        function goToPrev() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                updateURL(currentQuestionIndex);
                renderQuestion(currentQuestionIndex);
            }
        }
        
        /** モーダルを開く */
        function openModal() {
            modalCurrentQ.textContent = `${currentQuestionIndex + 1}`;
            modalTotalQ.textContent = `${questions.length}`;
            settingsModal.classList.remove('hidden');
            // アニメーションのため少し遅延させる
            setTimeout(() => {
                modalContent.classList.remove('opacity-0', '-translate-y-10');
                modalContent.classList.add('opacity-100', 'translate-y-0');
            }, 10);
        }

        /** モーダルを閉じる */
        function closeModal() {
            modalContent.classList.add('opacity-0', '-translate-y-10');
            modalContent.classList.remove('opacity-100', 'translate-y-0');
            setTimeout(() => {
                settingsModal.classList.add('hidden');
            }, 300);
        }


        // --- イベントリスナーの設定 ---
        document.addEventListener('DOMContentLoaded', () => {
            currentQuestionIndex = getQuestionIndexFromURL();
            renderQuestion(currentQuestionIndex);
        });
        
        // ブラウザの戻る/進むボタンに対応
        window.addEventListener('popstate', (event) => {
            currentQuestionIndex = getQuestionIndexFromURL();
            renderQuestion(currentQuestionIndex);
        });

        showAnswerBtn.addEventListener('click', showAnswer);
        skipBtn.addEventListener('click', goToNext);
        nextBtn.addEventListener('click', goToNext);
        prevBtn.addEventListener('click', goToPrev);
        
        settingsBtn.addEventListener('click', openModal);
        closeModalBtn.addEventListener('click', closeModal);
        // モーダルの背景クリックで閉じる
        settingsModal.addEventListener('click', (e) => {
            if (e.target === settingsModal) {
                closeModal();
            }
        });

    </script>
</body>
</html>
